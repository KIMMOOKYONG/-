![image](https://user-images.githubusercontent.com/102650331/182150315-b0f8dd61-fa2f-4184-80e4-d9121c595c3d.png)

# 설치
```
!pip install pyupbit

```

# position_sizing.py
```python
# 주가 변동성을 기반으로 투자금액 결정(position size)
# 일봉 기준으로 주가 변동성 계산
# True Range = Max(Abs(High - Low), Abs(Previous Close - High), Abs(Previous Close - Low))
# 주가 변동성을 표현하기 위해 N이라는 단어를 사용
# ATR (Average True Range)
# N = (19 * PDN + TR) / 20, PDN: 이전 거래일의 N, TR: 현재 거래일의 N

# 주가 데이터 가져오기
import pyupbit
df = pyupbit.get_ohlcv("KRW-BTC")
df.tail()

# 각 거래일에 대해서 TR (True Range) 값을 계산
df["pclose"] = df["close"].shift(1)
df["diff1"] = abs(df["high"] - df["low"])
df["diff2"] = abs(df["pclose"] - df["high"])
df["diff3"] = abs(df["pclose"] - df["low"])
df["TR"] = df[["diff1", "diff2", "diff3"]].max(axis=1)

# 주가 변동성을 기반으로 투자금액 결정(position size)
# 일봉 기준으로 주가 변동성 계산
# True Range = Max(Abs(High - Low), Abs(Previous Close - High), Abs(Previous Close - Low))
# 주가 변동성을 표현하기 위해 N이라는 단어를 사용
# ATR (Average True Range)
# N = (19 * PDN + TR) / 20, PDN: 이전 거래일의 N, TR: 현재 거래일의 N

import numpy as np

# 데이터의 가장 첫번째 거래일에서는 이전 거래일의 N 값이 없으므로 N을 구할 수 없다.
# 각 거래일의 N 값은 이전 거래일의 N에 가중치를 19/20을 주고 당일 거래일의 TR 값에 가중치를 1/20을 준 가중 평균값
# 따라서 첫 번째 거래일의 N은 TR 값을 그대로 사용하며 이는 가중치를 1로 줌.
data = np.array(df["TR"]) # no previous day's N
for i in range(1, len(df)):
    data[i] = (19 * data[i - 1] + df["TR"].iloc[i]) / 20

df["N"] = data


```
