# 패키지 설치
```
!pip install pykrx
!pip install pandas_ta

```

# 데이터 수집
```python
from pykrx import stock

df = stock.get_market_ohlcv_by_date(fromdate="20200101", todate="20220728", ticker="005930")
df = df.reset_index()

df.columns = ["time", "Open", "High", "Low", "Close", "Volume"]
df = df[df["Volume"] != 0]

```

# 지수이동평균 시그널
```python
# 일별 ema 시그널 저장
emasignal = [0] * len(df)

# 현재가와 비교할 과거 주가들(기간: 일)
# 과거 4일전 주가와 비교, 변경 가능
backcandles = 4 

for row in range(backcandles, len(df)):
    upt = 1 # 상승
    dnt = 1 # 하락
    for i in range(row - backcandles, row + 1):
        # 당일 고가가 지수 이동평균 가격보다 높으면, 하락 추세 아님
        if df.High[i] >= df.EMA[i]:
            dnt = 0

        # 지수이동평균 가격이 당일 저가 보다 높으면, 상승 추세 아님
        if df.Low[i] <= df.EMA[i]:
            upt = 0

    if upt == 1 and dnt == 1:
        print("!!!!! check trend loop !!!!")
        emasignal[row] = 3 # 상승, 하락 아님. 횡보 ???
    elif upt == 1:
        emasignal[row] = 2 # 상승, 매수 시그널
    elif dnt == 1:
        emasignal[row] = 1  # 하락, 매도 시그널

df["EMASignal"] = emasignal

```
