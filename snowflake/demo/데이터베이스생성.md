# 데이터 베이스 생성
![image](https://user-images.githubusercontent.com/102650331/172084991-2b92cf9a-c00a-4a5a-9173-0ae36b0d7fb3.png)

```sql
use role sysadmin;
use database employees;
use schema public;

```

# 테이블 삭제
```sql
DROP TABLE IF EXISTS dept_emp;
DROP TABLE IF EXISTS dept_manager;
DROP TABLE IF EXISTS titles;
DROP TABLE IF EXISTS salaries;
DROP TABLE IF EXISTS employees; 
DROP TABLE IF EXISTS departments;

```

# mysql to snowflake
- https://hevodata.com/blog/mysql-to-snowflake-data-migration-steps/
- https://three-pleasure.tistory.com/196

![image](https://user-images.githubusercontent.com/102650331/172085702-e1b714e3-dc44-471d-9d88-5c2c386bb9df.png)

# 테이블 생성
```sql
create or replace table employees (
    emp_no      integer         not null,
    birth_date  date            not null,
    first_name  varchar(14)     not null,
    last_name   varchar(16)     not null,
    gender      char(1)  not null,
    hire_date   date            not null,
    primary key (emp_no)
);

create or replace table departments (
    dept_no     char(4)         not null,
    dept_name   varchar(40)     not null,
    primary key (dept_no)
);

create or replace table dept_manager (
   emp_no       integer         not null,
   dept_no      char(4)         not null,
   from_date    date            not null,
   to_date      date            not null,
   foreign key (emp_no)  references employees (emp_no)    on delete cascade,
   foreign key (dept_no) references departments (dept_no) on delete cascade,
   primary key (emp_no,dept_no)
); 

create or replace table dept_emp (
    emp_no      integer         not null,
    dept_no     char(4)         not null,
    from_date   date            not null,
    to_date     date            not null,
    foreign key (emp_no)  references employees   (emp_no)  on delete cascade,
    foreign key (dept_no) references departments (dept_no) on delete cascade,
    primary key (emp_no,dept_no)
);

create or replace table titles (
    emp_no      integer         not null,
    title       varchar(50)     not null,
    from_date   date            not null,
    to_date     date,
    foreign key (emp_no) references employees (emp_no) on delete cascade,
    primary key (emp_no,title, from_date)
) 
; 

create or replace table salaries (
    emp_no      integer         not null,
    salary      integer         not null,
    from_date   date            not null,
    to_date     date            not null,
    foreign key (emp_no) references employees (emp_no) on delete cascade,
    primary key (emp_no, from_date)
) 
;

```

```sql
CREATE OR REPLACE VIEW dept_emp_latest_date AS
    SELECT emp_no, MAX(from_date) AS from_date, MAX(to_date) AS to_date
    FROM dept_emp
    GROUP BY emp_no;

# shows only the current department for each employee
CREATE OR REPLACE VIEW current_dept_emp AS
    SELECT l.emp_no, dept_no, l.from_date, l.to_date
    FROM dept_emp d
        INNER JOIN dept_emp_latest_date l
        ON d.emp_no=l.emp_no AND d.from_date=l.from_date AND l.to_date = d.to_date;

```
